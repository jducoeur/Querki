/*!
 * jQuery UI Widget 1.8.21
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Widget
 */
/*!
 * Marco Polo v1.8.0
 *
 * A jQuery autocomplete plugin for the discerning developer.
 *
 * https://github.com/jstayton/jquery-marcopolo
 *
 * Copyright 2013 by Justin Stayton
 * Licensed MIT
 */
/*!
 * Manifest v1.3.6
 * FORKED, to split DELETE and BACKSPACE, and to make other changes.
 * Forked source: https://github.com/jducoeur/Querki/blob/master/querki/public/javascripts/jquery.manifest.js
 *
 * A jQuery plugin that adds delight to selecting multiple values for an input.
 *
 * https://github.com/jstayton/jquery-manifest
 *
 * Copyright 2013 by Justin Stayton
 * Licensed MIT
 */

(function(e,t){if(e.cleanData){var n=e.cleanData;e.cleanData=function(t){for(var r=0,i;(i=t[r])!=null;r++){try{e(i).triggerHandler("remove")}catch(s){}}n(t)}}else{var r=e.fn.remove;e.fn.remove=function(t,n){return this.each(function(){if(!n){if(!t||e.filter(t,[this]).length){e("*",this).add([this]).each(function(){try{e(this).triggerHandler("remove")}catch(t){}})}}return r.call(e(this),t,n)})}}e.widget=function(t,n,r){var i=t.split(".")[0],s;t=t.split(".")[1];s=i+"-"+t;if(!r){r=n;n=e.Widget}e.expr[":"][s]=function(n){return!!e.data(n,t)};e[i]=e[i]||{};e[i][t]=function(e,t){if(arguments.length){this._createWidget(e,t)}};var o=new n;o.options=e.extend(true,{},o.options);e[i][t].prototype=e.extend(true,o,{namespace:i,widgetName:t,widgetEventPrefix:e[i][t].prototype.widgetEventPrefix||t,widgetBaseClass:s},r);e.widget.bridge(t,e[i][t])};e.widget.bridge=function(n,r){e.fn[n]=function(i){var s=typeof i==="string",o=Array.prototype.slice.call(arguments,1),u=this;i=!s&&o.length?e.extend.apply(null,[true,i].concat(o)):i;if(s&&i.charAt(0)==="_"){return u}if(s){this.each(function(){var r=e.data(this,n),s=r&&e.isFunction(r[i])?r[i].apply(r,o):r;if(s!==r&&s!==t){u=s;return false}})}else{this.each(function(){var t=e.data(this,n);if(t){t.option(i||{})._init()}else{e.data(this,n,new r(i,this))}})}return u}};e.Widget=function(e,t){if(arguments.length){this._createWidget(e,t)}};e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:false},_createWidget:function(t,n){e.data(n,this.widgetName,this);this.element=e(n);this.options=e.extend(true,{},this.options,this._getCreateOptions(),t);var r=this;this.element.bind("remove."+this.widgetName,function(){r.destroy()});this._create();this._trigger("create");this._init()},_getCreateOptions:function(){return e.metadata&&e.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName);this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled "+"ui-state-disabled")},widget:function(){return this.element},option:function(n,r){var i=n;if(arguments.length===0){return e.extend({},this.options)}if(typeof n==="string"){if(r===t){return this.options[n]}i={};i[n]=r}this._setOptions(i);return this},_setOptions:function(t){var n=this;e.each(t,function(e,t){n._setOption(e,t)});return this},_setOption:function(e,t){this.options[e]=t;if(e==="disabled"){this.widget()[t?"addClass":"removeClass"](this.widgetBaseClass+"-disabled"+" "+"ui-state-disabled").attr("aria-disabled",t)}return this},enable:function(){return this._setOption("disabled",false)},disable:function(){return this._setOption("disabled",true)},_trigger:function(t,n,r){var i,s,o=this.options[t];r=r||{};n=e.Event(n);n.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase();n.target=this.element[0];s=n.originalEvent;if(s){for(i in s){if(!(i in n)){n[i]=s[i]}}}this.element.trigger(n,r);return!(e.isFunction(o)&&o.call(this.element[0],n,r)===false||n.isDefaultPrevented())}}})(jQuery);(function(e){"use strict";if(typeof define==="function"&&define.amd){define(["jquery"],e)}else{e(jQuery)}})(function(e,t){"use strict";var n={};e.widget("mp.marcoPolo",{options:{cache:true,compare:false,data:{},delay:250,formatData:null,formatError:function(){return"<em>Your search could not be completed at this time.</em>"},formatItem:function(e){return e.title||e.name},formatMinChars:function(e){return"<em>Your search must be at least <strong>"+e+"</strong> characters.</em>"},formatNoResults:function(e){return"<em>No results for <strong>"+e+"</strong>.</em>"},hideOnSelect:true,highlight:true,label:null,minChars:1,onBlur:null,onChange:null,onError:null,onFocus:null,onMinChars:null,onNoResults:null,onRequestBefore:null,onRequestAfter:null,onResults:null,onSelect:function(e){this.val(e.title||e.name)},param:"q",required:false,selectable:"*",selected:null,submitOnEnter:false,url:null},keys:{DOWN:40,END:35,ENTER:13,ESC:27,HOME:36,TAB:9,UP:38},_create:function(){var t=this,n;t.$input=n=t.element.addClass("mp_input");t.inputName="mp_"+(n.attr("name")||e.now());t.$list=e('<ol class="mp_list" />').attr({"aria-atomic":"true","aria-busy":"false","aria-live":"polite",id:t.inputName+"_list",role:"listbox"}).hide().insertAfter(t.$input);t.inputOriginals={"aria-activedescendant":n.attr("aria-activedescendant"),"aria-autocomplete":n.attr("aria-autocomplete"),"aria-expanded":n.attr("aria-expanded"),"aria-labelledby":n.attr("aria-labelledby"),"aria-owns":n.attr("aria-owns"),"aria-required":n.attr("aria-required"),autocomplete:n.attr("autocomplete"),role:n.attr("role")};n.attr({"aria-autocomplete":"list","aria-owns":t.$list.attr("id"),autocomplete:"off",role:"combobox"});t.ajax=null;t.ajaxAborted=false;t.documentMouseup=null;t.focusPseudo=false;t.focusReal=false;t.mousedown=false;t.selectedData=null;t.selectedMouseup=false;t.timer=null;t.value=t.$input.val();t._bindInput()._bindList()._bindDocument();t._initSelected()._initOptions()},_setOption:function(t,n){e.Widget.prototype._setOption.apply(this,arguments);this._initOptions(t,n)},_initOptions:function(n,r){var i=this,s=n===t,o={};if(s){o=i.options}else{o[n]=r}e.each(o,function(t,n){switch(t){case"label":i.options.label=e(n).addClass("mp_label");if(i.options.label.attr("id")){i.removeLabelId=false}else{i.removeLabelId=true;i.options.label.attr("id",i.inputName+"_label")}i._toggleLabel();i.$input.attr("aria-labelledby",i.options.label.attr("id"));break;case"required":i.$input.attr("aria-required",n);break;case"selected":if(s&&n){i.select(n,null,true)}break;case"url":if(!n){i.options.url=i.$input.closest("form").attr("action")}break}});return i},invalidateCache:function(){n={}},change:function(e,t){var n=this;if(e===n.value){return}if(e!==n.$input.val()){n.$input.val(e)}n.selectedData=null;n.value=e;n._trigger("change",[e]);if(t!==true){if(n.focusPseudo){n._cancelPendingRequest()._hideAndEmptyList()}else{n._toggleLabel()}}},search:function(e){var n=this.$input;if(e!==t){n.val(e)}n.focus()},select:function(e,t,n){var r=this,i=r.$input,s=r.options.hideOnSelect;if(s){r._hideList()}if(!e){return r.change("")}r.selectedData=e;r._trigger("select",[e,t,!!n]);if(i.val()!==r.value){r.value=i.val();if(!r.focusPseudo){r._toggleLabel()}r._hideAndEmptyList()}},_initSelected:function(){var e=this,t=e.$input,n=t.data("selected"),r=t.val();if(n){e.select(n,null,true)}else if(r){e.select(r,null,true)}return e},selected:function(){return this.selectedData},destroy:function(){var n=this,r=n.options,i=n.$input;n.$list.remove();e.each(n.inputOriginals,function(e,n){if(n===t){i.removeAttr(e)}else{i.attr(e,n)}});i.removeClass("mp_input");if(r.label){r.label.removeClass("mp_label");if(n.removeLabelId){r.label.removeAttr("id")}}e(document).unbind("mouseup.marcoPolo",n.documentMouseup);e.Widget.prototype.destroy.apply(n,arguments)},list:function(){return this.$list},_bindInput:function(){var t=this,n=t.$input,r=t.$list;n.bind("focus.marcoPolo",function(){if(t.focusReal){return}t.focusPseudo=true;t.focusReal=true;t._toggleLabel();if(t.selectedMouseup){t.selectedMouseup=false}else{t._trigger("focus");t._request(n.val())}}).bind("keydown.marcoPolo",function(n){var i=e();switch(n.which){case t.keys.UP:n.preventDefault();t._showList()._highlightPrev();break;case t.keys.DOWN:n.preventDefault();t._showList()._highlightNext();break;case t.keys.HOME:n.preventDefault();t._showList()._highlightFirst();break;case t.keys.END:n.preventDefault();t._showList()._highlightLast();break;case t.keys.ENTER:if(!r.is(":visible")){if(!t.options.submitOnEnter){n.preventDefault()}return}i=t._highlighted();if(i.length){t.select(i.data("marcoPolo"),i)}if(!t.options.submitOnEnter||i.length){n.preventDefault()}break;case t.keys.TAB:if(!r.is(":visible")){return}i=t._highlighted();if(i.length){t.select(i.data("marcoPolo"),i)}break;case t.keys.ESC:t._cancelPendingRequest()._hideList();break}}).bind("keyup.marcoPolo",function(){if(n.val()!==t.value){t._request(n.val())}}).bind("blur.marcoPolo",function(){t.focusReal=false;setTimeout(function(){if(!t.mousedown){t._dismiss()}},1)});return t},_bindList:function(){var t=this;t.$list.bind("mousedown.marcoPolo",function(){t.mousedown=true}).delegate("li.mp_selectable","mouseover",function(){t._addHighlight(e(this))}).delegate("li.mp_selectable","mouseout",function(){t._removeHighlight(e(this))}).delegate("li.mp_selectable","mouseup",function(){var n=e(this);t.select(n.data("marcoPolo"),n);t.selectedMouseup=true;t.$input.focus()});return t},_bindDocument:function(){var t=this;e(document).bind("mouseup.marcoPolo",t.documentMouseup=function(){t.mousedown=false;if(!t.focusReal&&t.$list.is(":visible")){t._dismiss()}});return t},_toggleLabel:function(){var e=this,t=e.options.label;if(t&&t.length){if(e.focusPseudo||e.$input.val()){t.hide()}else{t.show()}}return e},_firstSelectableItem:function(){return this.$list.children("li.mp_selectable:visible:first")},_lastSelectableItem:function(){return this.$list.children("li.mp_selectable:visible:last")},_highlighted:function(){return this.$list.children("li.mp_highlighted")},_removeHighlight:function(e){e.removeClass("mp_highlighted").attr("aria-selected","false").removeAttr("id");this.$input.removeAttr("aria-activedescendant");return this},_addHighlight:function(e){this._removeHighlight(this._highlighted());e.addClass("mp_highlighted").attr({"aria-selected":"true",id:this.inputName+"_highlighted"});this.$input.attr("aria-activedescendant",e.attr("id"));return this},_highlightFirst:function(){this._addHighlight(this._firstSelectableItem());return this},_highlightLast:function(){this._addHighlight(this._lastSelectableItem());return this},_highlightPrev:function(){var e=this._highlighted(),t=e.prevAll("li.mp_selectable:visible:first");if(!t.length){t=this._lastSelectableItem()}this._addHighlight(t);return this},_highlightNext:function(){var e=this._highlighted(),t=e.nextAll("li.mp_selectable:visible:first");if(!t.length){t=this._firstSelectableItem()}this._addHighlight(t);return this},_showList:function(){if(this.$list.children().length){this.$list.show();this.$input.attr("aria-expanded","true")}return this},_hideList:function(){this.$list.hide();this.$input.removeAttr("aria-activedescendant").removeAttr("aria-expanded");return this},_emptyList:function(){this.$list.empty();this.$input.removeAttr("aria-activedescendant");return this},_hideAndEmptyList:function(){this.$list.hide().empty();this.$input.removeAttr("aria-activedescendant").removeAttr("aria-expanded");return this},_buildNoResultsList:function(t){var n=this,r=n.$input,i=n.$list,s=n.options,o=e('<li class="mp_no_results" role="alert" />'),u;u=s.formatNoResults&&s.formatNoResults.call(r,t,o);if(u){o.html(u)}n._trigger("noResults",[t,o]);if(u){o.appendTo(i);n._showList()}else{n._hideList()}return n},_buildResultsList:function(t,n){var r=this,i=r.$input,s=r.$list,o=r.options,u=r.selectedData,a=o.compare&&u,f,l,c=false,h,p=e(),d;for(var v=0,m=n.length;v<m;v++){h=n[v];p=e('<li class="mp_item" />');d=o.formatItem.call(i,h,p);p.data("marcoPolo",h);p.html(d).appendTo(s);if(a&&o.highlight){if(o.compare===true){f=h;l=u}else{f=h[o.compare];l=u[o.compare]}if(f===l){r._addHighlight(p);a=false;c=true}}}s.children(o.selectable).addClass("mp_selectable").attr({"aria-selected":"false",role:"option"});r._trigger("results",[n]);r._showList();if(!c&&o.highlight){r._highlightFirst()}return r},_buildSuccessList:function(t,n){var r=this,i=r.$input,s=r.options;r._emptyList();if(s.formatData){n=s.formatData.call(i,n)}if(!n||n.length===0||e.isEmptyObject(n)){r._buildNoResultsList(t)}else{r._buildResultsList(t,n)}return r},_buildErrorList:function(t,n,r){var i=this,s=i.$input,o=i.$list,u=i.options,a=e('<li class="mp_error" role="alert" />'),f;i._emptyList();f=u.formatError&&u.formatError.call(s,a,t,n,r);if(f){a.html(f)}i._trigger("error",[a,t,n,r]);if(f){a.appendTo(o);i._showList()}else{i._hideList()}return i},_buildMinCharsList:function(t){var n=this,r=n.$input,i=n.$list,s=n.options,o=e('<li class="mp_min_chars" role="alert" />'),u;if(!t.length){n._hideAndEmptyList();return n}n._emptyList();u=s.formatMinChars&&s.formatMinChars.call(r,s.minChars,o);if(u){o.html(u)}n._trigger("minChars",[s.minChars,o]);if(u){o.appendTo(i);n._showList()}else{n._hideList()}return n},_cancelPendingRequest:function(){var e=this;if(e.ajax){e.ajaxAborted=true;e.ajax.abort()}else{e.ajaxAborted=false}clearTimeout(e.timer);return e},_request:function(t){var r=this,i=r.$input,s=r.$list,o=r.options;r._cancelPendingRequest();r.change(t,true);r.timer=setTimeout(function(){var u={},a={},f={},l,c=e();if(t.length<o.minChars){r._buildMinCharsList(t);return r}u=e.isFunction(o.data)?o.data.call(r.$input,t):o.data;a[o.param]=t;f=e.extend({},u,a);l=o.url+(o.url.indexOf("?")===-1?"?":"&")+e.param(f);if(o.cache&&n[l]){r._buildSuccessList(t,n[l])}else{r._trigger("requestBefore");c=i.parent().addClass("mp_busy");s.attr("aria-busy","true");r.ajax=e.ajax({url:o.url,dataType:"json",data:f,success:function(e){r._buildSuccessList(t,e);if(o.cache){n[l]=e}},error:function(e,t,n){if(!r.ajaxAborted){r._buildErrorList(e,t,n)}},complete:function(e,t){r.ajax=null;r.ajaxAborted=false;c.removeClass("mp_busy");s.attr("aria-busy","false");r._trigger("requestAfter",[e,t])}})}},o.delay);return r},_dismiss:function(){var e=this,t=e.options;e.focusPseudo=false;e._cancelPendingRequest()._hideAndEmptyList();if(t.required&&!e.selectedData){e.change("",true)}e._toggleLabel()._trigger("blur");return e},_trigger:function(t,n){var r=this,i="on"+t.charAt(0).toUpperCase()+t.slice(1),s=r.widgetEventPrefix.toLowerCase()+t.toLowerCase(),o=e.isArray(n)?n:[],u=r.options[i];r.element.trigger(s,o);return u&&u.apply(r.element,o)}})});(function(e){"use strict";if(typeof define==="function"&&define.amd){define(["jquery"],e)}else{e(jQuery)}})(function(e,t){"use strict";e.widget("mf.manifest",{options:{formatDisplay:function(e,t,n){if(n){return n.html()}else{return e}},formatRemove:function(){return"X"},formatValue:function(e,t,n,r){if(r){return r.text()}else{return e}},marcoPolo:false,onAdd:null,onChange:null,onHighlight:null,onHighlightRemove:null,onRemove:null,onSelect:null,onSelectRemove:null,required:false,separator:",",values:null,valuesName:null},_marcoPoloOptions:function(){var e=this,t=e.options;return{onFocus:function(){if(t.marcoPolo.onFocus){t.marcoPolo.onFocus.call(this)}e._resizeInput()},onRequestAfter:function(){e.$container.parent().removeClass("mf_busy");if(t.marcoPolo.onRequestAfter){t.marcoPolo.onRequestAfter.call(this)}},onRequestBefore:function(){e.$container.parent().addClass("mf_busy");if(t.marcoPolo.onRequestBefore){t.marcoPolo.onRequestBefore.call(this)}},onSelect:function(n,r){var i=true;if(t.marcoPolo.onSelect){i=t.marcoPolo.onSelect.call(this,n,r)}if(i!==false){e.add(n,r,true,false,false)}},required:t.required}},keys:{BACKSPACE:8,DELETE:46,DOWN:40,END:35,ENTER:13,HOME:36,LEFT:37,RIGHT:39,UP:38},_create:function(){var t=this,n=t.options,r,i;t.$input=i=t.element.addClass("mf_input");t.inputName="mf_"+(i.attr("name")||e.now());t.$container=e('<div class="mf_container" />');t.$list=e('<ol class="mf_list" />').attr({"aria-atomic":"false","aria-live":"polite","aria-multiselectable":"true",id:t.inputName+"_list",role:"listbox"});t.$measure=e('<span class="mf_measure" />');t.mousedown=false;t.mpMousedown=false;t.inputOriginals={"aria-owns":i.attr("aria-owns"),role:i.attr("role"),width:i.css("width")};if(n.marcoPolo){r=i.val();i.val("");t._bindMarcoPolo();i.attr("aria-owns",i.attr("aria-owns")+" "+t.$list.attr("id"));i.val(r)}else{i.attr({"aria-owns":t.$list.attr("id"),role:"combobox"})}t._bindInput()._bindList()._bindContainer()._bindDocument();i.wrap(t.$container).before(t.$list).after(t.$measure);t.$container=i.parent();if(n.values){t.add(n.values,null,false,true,false)}t._addInputValues()._styleMeasure()._resizeInput()},_setOption:function(t,n){var r=this,i=r.$input;switch(t){case"marcoPolo":if(r.options.marcoPolo){if(n){i.marcoPolo("option",e.extend({},n,r._marcoPoloOptions()))}else{i.marcoPolo("destroy")}}else if(n){r._bindMarcoPolo(e.extend({},n,r._marcoPoloOptions()));i.marcoPolo("list").insertAfter(i.parent())}break;case"required":if(r.options.marcoPolo){i.marcoPolo("option","required",n)}break;case"values":r.add(n,null,false,false,false);break;case"valuesName":r.$list.find("input:hidden.mf_value").attr("name",n+"[]");break}e.Widget.prototype._setOption.apply(r,arguments)},_bindMarcoPolo:function(n){var r=this,i=r.$input,s=r.options;if(n===t){n=e.extend({},s.marcoPolo,r._marcoPoloOptions())}i.marcoPolo(n);i.marcoPolo("list").bind("mousedown.manifest",function(){r.mpMousedown=true});return r},_bindInput:function(){var t=this,n=t.$input,r=t.options,i=r.marcoPolo&&r.marcoPolo.minChars===0,s=[t.keys.UP,t.keys.DOWN,t.keys.HOME,t.keys.END];n.bind("keydown.manifest",function(o){t._resizeInput();if(!r.required&&t._isSeparator(o.which)){o.preventDefault();if(n.val()){t.add(n.val(),null,true,false,true)}return}if(o.which===t.keys.ENTER){o.preventDefault();return}if(n.val()){return}if(i&&e.inArray(o.which,s)!==-1){return}switch(o.which){case t.keys.DELETE:var u=t._selected();t.remove(u);break;case t.keys.BACKSPACE:case t.keys.LEFT:case t.keys.UP:t._selectPrev();break;case t.keys.RIGHT:case t.keys.DOWN:t._selectNext();break;case t.keys.HOME:t._selectFirst();break;case t.keys.END:t._selectLast();break;default:t._removeSelected();break}}).bind("keypress.manifest",function(e){if(!r.required&&t._isSeparator(String.fromCharCode(e.which))){e.preventDefault();if(n.val()){t.add(n.val(),null,true,false,true)}}}).bind("keyup.manifest",function(){t._resizeInput()}).bind("paste.manifest",function(){setTimeout(function(){t._resizeInput();if(!r.required&&n.val()){t.add(t._splitBySeparator(n.val()),null,true,false,true)}},1)}).bind("blur.manifest",function(){setTimeout(function(){if(!t.mousedown){t._removeSelected()}if(!t.mpMousedown){if(r.marcoPolo&&r.required){t._resizeInput()}else if(n.val()){t.add(n.val(),null,true,false,true)}}},1)});return t},_bindList:function(){var t=this;t.$list.delegate("li","mouseover",function(){t._addHighlight(e(this))}).delegate("li","mouseout",function(){t._removeHighlight(e(this))}).delegate("li","mousedown",function(){t.mousedown=true}).delegate("li","click",function(n){if(e(n.target).is("a.mf_remove")){t._removeSelected();t.remove(e(this));n.preventDefault()}else{t._toggleSelect(e(this))}});return t},_bindContainer:function(){var e=this;e.$container.bind("click.manifest",function(){e.$input.focus()});return e},_bindDocument:function(){var t=this,n=t.$input;e(document).bind("mouseup.manifest",function(r){if(t.mousedown){t.mousedown=false;if(!e(r.target).is("li.mf_item, li.mf_item *")){t._removeSelected()}}if(t.mpMousedown){t.mpMousedown=false;if(t.options.required){t._resizeInput()}else if(n.val()){t.add(n.val(),null,true,false,true)}}});return t},container:function(){return this.$container},list:function(){return this.$list},add:function(t,n,r,i,s){var o=this,u=o.$input,a=o.options,f=e.isArray(t)?t:[t],l,c=e(),h=e(),p=e(),d=function(t,n,r){c.html(t);h.html(n);p.val(r);c.append(h,p);e.when(o._trigger("add",[l,c,!!i])).then(function(e){if(e!==false){c.appendTo(o.$list);if(!i){o._trigger("change",["add",l,c])}}})};if(s){u.marcoPolo("invalidateCache")}for(var v=0,m=f.length;v<m;v++){l=f[v];if(typeof l==="string"){l=e.trim(l)}if(!l||e.isPlainObject(l)&&e.isEmptyObject(l)){continue}c=e('<li class="mf_item" role="option" aria-selected="false" />');h=e('<a href="#" class="mf_remove" title="Remove" />');p=e('<input type="hidden" class="mf_value" />');if(a.valuesName){p.attr("name",a.valuesName+"[]")}else{p.attr("name",u.attr("name")+"_values[]")}c.data("manifest",l);e.when(a.formatDisplay.call(u,l,c,n),a.formatRemove.call(u,h,c),a.formatValue.call(u,l,p,c,n)).then(d)}if(r){o._clearInputValue()}},_addInputValues:function(){var t=this,n=t.$input,r=n.data("values"),i=n.val(),s=[];if(r){s=e.isArray(r)?r:[r]}else if(i){s=t._splitBySeparator(i)}if(s.length){t.add(s,null,true,true,false)}return t},remove:function(t){var n=this,r=e();if(t instanceof jQuery){r=t}else{r=n.$list.children(t)}r.each(function(){var t=e(this),r=t.data("manifest");e.when(n._trigger("remove",[r,t])).then(function(e){if(e!==false){if(n._isSelected(t)){n._removeSelect(t)}t.remove();n._trigger("change",["remove",r,t])}})})},values:function(){var t=this,n=t.$list,r=[];n.find("input:hidden.mf_value").each(function(){r.push(e(this).val())});return r},destroy:function(){var n=this,r=n.$input;if(n.options.marcoPolo){r.marcoPolo("destroy")}n.$list.remove();n.$measure.remove();r.unwrap().removeClass("mf_input").val(n._joinWithSeparator(n.values()));e.each(n.inputOriginals,function(e,n){if(n===t){r.removeAttr(e)}else{r.attr(e,n)}});e(document).unbind(".manifest");e.Widget.prototype.destroy.apply(n,arguments)},_styleMeasure:function(){var e=this,t=e.$input;e.$measure.css({"font-family":t.css("font-family"),"font-size":t.css("font-size"),"font-style":t.css("font-style"),"font-variant":t.css("font-variant"),"font-weight":t.css("font-weight"),left:-9999,"letter-spacing":t.css("letter-spacing"),position:"absolute","text-transform":t.css("text-transform"),top:-9999,"white-space":"nowrap",width:"auto","word-spacing":t.css("word-spacing")});return e},_measureText:function(e){var t=this.$measure,n;n=e.replace(/&/g,"&").replace(/\s/g,"&nbsp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");t.html(n);return t.width()},_maxInputWidth:function(){var e=this,t=e.$container,n=e.$input;return t.width()-(n.outerWidth(true)-n.width())},_resizeInput:function(){var e=this,t=e.$input,n;n=e._measureText(t.val()+"---");t.width(Math.min(n,e._maxInputWidth()));return e},_clearInputValue:function(){var e=this,t=e.$input;if(e.options.marcoPolo){t.marcoPolo("change",null)}else{t.val("")}e._resizeInput();return e},_isSeparator:function(t){var n=this.options.separator;if(e.isArray(n)){return e.inArray(t,n)!==-1}else{return t===n}},_separators:function(t){var n=this.options.separator,r=e.isArray(n)?n:[n];if(t){r=e.grep(r,function(e){return typeof e==="string"})}return r},_firstSeparator:function(e){return this._separators(e).shift()},_splitBySeparator:function(t){var n=this._separators(true),r=t;if(n.length){r=t.split(new RegExp("[\\"+n.join("\\")+"]"));r=e.map(r,e.trim)}return r},_joinWithSeparator:function(e){var t=this._firstSeparator(true)||"";return e.join(t+" ")},_firstItem:function(){return this.$list.children("li:first")},_lastItem:function(){return this.$list.children("li:last")},_highlighted:function(){return this.$list.children("li.mf_highlighted")},_addHighlight:function(e){var t=this;if(!e.length){return t}t._removeHighlighted();e.addClass("mf_highlighted");t._trigger("highlight",[e.data("marcoPolo"),e]);return t},_removeHighlight:function(e){var t=this;if(!e.length){return t}e.removeClass("mf_highlighted");t._trigger("highlightRemove",[e.data("marcoPolo"),e]);return t},_removeHighlighted:function(){return this._removeHighlight(this._highlighted())},_selected:function(){return this.$list.children("li.mf_selected")},_isSelected:function(e){return e.hasClass("mf_selected")},_addSelect:function(e){var t=this;if(!e.length){return t}t._removeSelected();e.addClass("mf_selected").attr({"aria-selected":"true",id:t.inputName+"_selected"});t.$list.attr("aria-activedescendant",e.attr("id"));t._trigger("select",[e.data("marcoPolo"),e]);return t},_removeSelect:function(e){var t=this;if(!e.length){return t}e.removeClass("mf_selected").attr("aria-selected","false").removeAttr("id");t.$list.removeAttr("aria-activedescendant");t._trigger("selectRemove",[e.data("marcoPolo"),e]);return t},_removeSelected:function(){return this._removeSelect(this._selected())},_toggleSelect:function(e){if(this._isSelected(e)){return this._removeSelect(e)}else{return this._addSelect(e)}},_selectPrev:function(){var t=this,n=t._selected(),r=e();if(n.length){r=n.prev()}else{r=t._lastItem()}if(r.length){t._addSelect(r)}return t},_selectNext:function(){var e=this,t=e._selected(),n=t.next();if(n.length){return e._addSelect(n)}else{return e._removeSelect(t)}},_selectFirst:function(){return this._addSelect(this._firstItem())},_selectLast:function(){return this._addSelect(this._lastItem())},_trigger:function(e,t){var n=this,r="on"+e.charAt(0).toUpperCase()+e.slice(1),i=n.widgetEventPrefix.toLowerCase()+e.toLowerCase(),s=n.options[r];n.element.trigger(i,t);return s&&s.apply(n.element,t)}})})